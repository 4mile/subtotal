(function(){var t,e=function(t,e){function l(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return l.prototype=e.prototype,t.prototype=new l,t.__super__=e.prototype,t},n={}.hasOwnProperty;(t=function(t){return"object"==typeof exports&&"object"==typeof module?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){var l,r;return l=function(t){function n(t,e){n.__super__.constructor.call(this,t,e)}var l;return e(n,t),l=function(t,e,n,l,r){var a,o,s,c,i,d,h;for(i=[],a=!1,c=0,d=l.length;c<d;c++)o=l[c],i.push(null!=(h=t[o])?h:"null"),s=i.join(String.fromCharCode(0)),e[s]||(e[s]=r(i.slice()),a=!0),e[s].push(t);return a&&n.push(i),i},n.prototype.processRecord=function(t){var e,n,r,a,o,s,c,i,d,h,u,p,f;if(f=[],e=[],this.allTotal.push(t),f=l(t,this.rowTotals,this.rowKeys,this.rowAttrs,function(t){return function(e){return t.aggregator(t,e,[])}}(this)),e=l(t,this.colTotals,this.colKeys,this.colAttrs,function(t){return function(e){return t.aggregator(t,[],e)}}(this)),d=f.length-1,h=e.length-1,!(d<0||h<0)){for(p=[],s=i=0,u=d;0<=u?i<=u:i>=u;s=0<=u?++i:--i)r=f.slice(0,s+1),o=r.join(String.fromCharCode(0)),this.tree[o]||(this.tree[o]={}),p.push(function(){var l,s,i;for(i=[],c=l=0,s=h;0<=s?l<=s:l>=s;c=0<=s?++l:--l)n=e.slice(0,c+1),a=n.join(String.fromCharCode(0)),this.tree[o][a]||(this.tree[o][a]=this.aggregator(this,r,n)),i.push(this.tree[o][a].push(t));return i}.call(this));return p}},n}(t.pivotUtilities.PivotData),t.pivotUtilities.SubtotalPivotData=l,r=function(e,l){var r,a,o,s,c,i,d,h,u,p,f,g,b,v,y,w,C,A,S,m,x,T,k,H,K,E,L,R,_,j,O,I,V,W,q,P,U,D;return H={localeStrings:{totals:"Totals"}},l=t.extend(H,l),a="▶",o="◢",w=e.colAttrs,O=e.rowAttrs,I=e.getRowKeys(),C=e.getColKeys(),D=e.tree,V=e.rowTotals,A=e.colTotals,r=e.allTotal,k=function(t,e,l,r){var a,o,s;if(o=document.createElement(t),e&&(o.className=e),null!==l&&void 0!==l&&(o.textContent=l),r)for(a in r)n.call(r,a)&&(s=r[a],o.setAttribute(a,s));return o},j=function(t,e){var n,l,r,a,o,s,c,i,d,h,u,p,f;for(s=t.length-1,o=t[0].length-1,h=[],a=[],p=k("th",e,t[0][0]),l=t[0][0],i=0,c={node:i,row:0,col:0,th:p,parent:null,children:[],descendants:o,leaves:1,flatKey:l},a[0]=c,h[0]=c,n=1;n<=o;)p=k("th",e,t[0][n]),l=l+String.fromCharCode(0)+t[0][n],++i,c={node:i,row:0,col:n,th:p,parent:h[n-1],children:[],descendants:o-n,leaves:1,flatKey:l},h[n]=c,h[n-1].children.push(c),++n;for(h[o].leaves=0,d=1;d<=s;){for(u=!0,l="",n=0;n<=o;)if(l=0===n?t[d][n]:l+String.fromCharCode(0)+t[d][n],t[d][n]===t[h[n].row][n]&&n!==o&&u)u=!0,++n;else{if(p=k("th",e,t[d][n]),++i,r={node:i,row:d,col:n,th:p,parent:null,children:[],descendants:0,leaves:1,flatKey:l},0===n)a.push(r);else for(r.parent=h[n-1],h[n-1].children.push(r),f=0;f<=n-1;)h[f].descendants=h[f].descendants+1,++f;h[n]=r,u=!1,++n}for(n=0;n<=o;)h[n].leaves=h[n].leaves+1,++n;h[o].leaves=0,++d}return a},s=function(t,e,n,l,r,a){var s,c,i;return s=l[a],i=k("th","pvtAxisLabel",s),c=s,a<l.length-1&&(c=" "+o+" "+s),i=k("th","pvtAxisLabel",c),i.setAttribute("data-colAttr",s),r.appendChild(i),e.push({tr:r,th:i,clickStatus:"expanded"}),t.appendChild(r)},c=function(t,e,n,l){var r,a,o,c,i;for(i=document.createElement("tr"),0!==n.length&&i.appendChild(k("th",null,null,{colspan:n.length,rowspan:l.length})),s(t,e,n,l,i,0),c=[],r=a=1,o=l.length;1<=o?a<=o:a>=o;r=1<=o?++a:--a)r<l.length&&(i=document.createElement("tr"),c.push(s(t,e,n,l,i,r)));return c},i=function(t,e,n){var l,r,a,o,s,c;for(s=[],r=a=0,o=n.length-1;0<=o?a<=o:a>=o;r=0<=o?++a:--a)r<n.length-1&&(c=t[r].th,l=n[r],s.push(c.onclick=function(l){return l=l||window.event,q(t,e,n,l.target.getAttribute("data-colAttr"))}));return s},d=function(t,e,n,l,r){var a,s,c,i,h,u,p,f;for(i=n.children,s=0,c=i.length;s<c;s++)a=i[s],d(t,e,a,l,r);return f=t[n.col].tr,p=n.th,p.setAttribute("data-colHeader",p.textContent),n.col===r.length-1&&0!==l.length&&p.setAttribute("rowspan",2),0!==n.children.length&&p.setAttribute("colspan",n.descendants+1),p.setAttribute("data-node",e.length),f.appendChild(p),0!==n.children.length&&(p.textContent=" "+o+" "+p.textContent,p.onclick=function(t){return t=t||window.event,W(e,parseInt(t.target.getAttribute("data-node")))},h=r.length-(n.col+1)+(0!==l.length?1:0),u="pvtColLabel col"+n.row,p=k("th",u,"",{rowspan:h}),n.children[0].tr.appendChild(p),n.sTh=p),n.clickStatus="expanded",n.tr=f,e.push(n)},f=function(t,e,n,l){var r,a,s,c,i;i=document.createElement("tr"),e.th=[];for(r in n)a=n[r],s=a,r<n.length-1&&(s=" "+o+" "+a),c=k("th","pvtAxisLabel",s),c.setAttribute("data-rowAttr",a),i.appendChild(c),e.th.push({th:c,clickStatus:"expanded"});return 0!==l.length&&(c=k("th"),i.appendChild(c)),t.appendChild(i),e.tr=i},g=function(t,e,n){var l,r,a,o,s,c;for(o=[],l=r=0,a=n.length-1;0<=a?r<=a:r>=a;l=0<=a?++r:--r)l<n.length-1&&(c=t.th[l],s=n[l],o.push(c.th.onclick=function(l){return l=l||window.event,U(t,e,n,l.target.getAttribute("data-rowAttr"))}));return o},v=function(t,e,n){var r,a;return r=1,0!==n.length&&(r=n.length+(0===e.length?0:1)),a=k("th","pvtTotalLabel",l.localeStrings.totals,{rowspan:r}),t.appendChild(a)},b=function(t,e,n,l,r){var a,s,c,i,d,h,u,p;for(p=document.createElement("tr"),u=n.th,u.setAttribute("rowspan",n.descendants+1),u.setAttribute("data-rowHeader",u.textContent),n.col===l.length-1&&0!==r.length&&u.setAttribute("colspan",2),u.setAttribute("data-node",e.length),p.appendChild(u),0!==n.children.length&&(u.textContent=" "+o+" "+u.textContent,u.onclick=function(t){return t=t||window.event,P(e,parseInt(t.target.getAttribute("data-node")))},a=l.length-(n.col+1)+(0!==r.length?1:0),u=k("th","pvtRowLabel","",{colspan:a}),p.appendChild(u)),n.clickStatus="expanded",n.tr=p,e.push(n),t.appendChild(p),d=n.children,h=[],c=0,i=d.length;c<i;c++)s=d[c],h.push(b(t,e,s,l,r));return h},y=function(t,e){var n,l,r,a,o,s,c,i,d,h,u,p,f,g,b,v;for(h=[],o=0,c=t.length;o<c;o++){for(u=t[o],b=u.tr,a=u.flatKey,s=0,i=e.length;s<i;s++)l=e[s],r=l.flatKey,n=null!=(d=D[a][r])?d:{value:function(){return null},format:function(){return""}},v=n.value(),p="pvtVal",p=0!==l.children.length?p+" pvtColSubtotal":p,p=0!==u.children.length?p+" pvtRowSubtotal":p,p=p+" row"+u.row+" col"+l.row+" rowcol"+u.col+" colcol"+l.col,f=k("td",p,n.format(v),{"data-value":v}),b.appendChild(f);g=V[a],v=g.value(),f=k("td","pvtTotal rowTotal",g.format(v),{"data-value":v,"data-row":"row"+u.row,"data-col":"col"+u.col}),h.push(b.appendChild(f))}return h},u=function(t,e){var n,r,a;return a=document.createElement("tr"),n=t.length+(0===e.length?0:1),r=k("th","pvtTotalLabel",l.localeStrings.totals,{colspan:n}),a.appendChild(r),a},h=function(t,e){var n,l,r,a,o,s,c,i;for(a=[],l=0,r=e.length;l<r;l++)n=e[l],c=A[n.flatKey],i=c.value(),o="pvtVal pvtTotal colTotal",o=n.children.length?o+" pvtColSubtotal":o,o=o+" col"+n.row+" colcol"+n.col,s=k("td",o,c.format(i),{"data-value":i,"data-for":"col"+n.col}),a.push(t.appendChild(s));return a},p=function(t,e){var n,l,a;return l=r,a=l.value(),n=k("td","pvtGrandTotal",l.format(a),{"data-value":a}),e.appendChild(n),t.appendChild(e)},S=function(e,n){var l,r,o,s,c,i,d;if(e[n]&&(o=e[n],"collapsed"!==o.clickStatus)){for(l=0,s=c=1,d=o.descendants;1<=d?c<=d:c>=d;s=1<=d?++c:--c)0!==o.descendants&&(r=e[n-s],0!==r.descendants&&(r.th.textContent=" "+a+" "+r.th.getAttribute("data-colHeader")),r.clickStatus="collapsed",r.th.setAttribute("colspan",1),"none"!==r.th.style.display&&(++l,r.th.style.display="none",r.children.length?t("table.pvtTable tbody tr td.pvtColSubtotal.col"+r.row+".colcol"+r.col).hide():t("table.pvtTable tbody tr td.pvtVal.col"+r.row).not(".pvtColSubtotal").hide(),r.sTh&&(r.sTh.style.display="none")));for(i=o.parent;null!==i;)i.th.setAttribute("colspan",parseInt(i.th.getAttribute("colspan"))-l),i=i.parent;return 0!==o.descendants&&(o.th.textContent=" "+a+" "+o.th.getAttribute("data-colHeader")),o.clickStatus="collapsed",o.th.setAttribute("colspan",1),o.th.style.display=""}},K=function(e,n){var l,r,s,c,i,d,h,u,p,f,g,b;if(e[n]&&(c=e[n],"expanded"!==c.clickStatus)){for(r=0,i=d=1,f=c.descendants;1<=f?d<=f:d>=f;i=1<=f?++d:--d)0!==c.descendants&&(s=e[n-i],0!==s.descendants&&(s.th.textContent=" "+a+" "+s.th.getAttribute("data-colHeader")),s.clickStatus="collapsed",s.th.setAttribute("colspan",1),"none"!==s.th.style.display&&(++r,s.th.style.display="none",s.children.length?t("table.pvtTable tbody tr td.pvtColSubtotal.col"+s.row+".colcol"+s.col).hide():t("table.pvtTable tbody tr td.pvtVal.col"+s.row).not(".pvtColSubtotal").hide(),s.sTh&&(s.sTh.style.display="none")));for(g=c.children,h=0,u=g.length;h<u;h++)l=g[h],"none"===l.th.style.display&&(++r,l.th.style.display="",l.children.length?t("table.pvtTable tbody tr td.pvtColSubtotal.col"+l.row+".colcol"+l.col).show():t("table.pvtTable tbody tr td.pvtVal.col"+l.row).not(".pvtColSubtotal").show(),l.sTh&&(l.sTh.style.display=""));for(c.th.setAttribute("colspan",c.children.length+1),0!==c.descendants&&(c.th.textContent=" "+o+" "+c.th.getAttribute("data-colHeader")),c.clickStatus="expanded",c.th.style.display="",c.sTh&&(c.sTh.style.display=""),p=c.parent,b=[];null!==p;)p.th.setAttribute("colspan",r+parseInt(p.th.getAttribute("colspan"))),b.push(p=p.parent);return b}},x=function(t,e){var n,l,r,o,s,c,i;if(t[e]&&(l=t[e],"collapsed"!==l.clickStatus)){for(i=0,r=o=1,c=l.descendants;1<=c?o<=c:o>=c;r=1<=c?++o:--o)0!==l.descendants&&(n=t[e+r],0!==n.descendants&&(n.th.textContent=" "+a+" "+n.th.getAttribute("data-rowHeader")),n.clickStatus="collapsed",n.th.setAttribute("rowspan",1),"none"!==n.tr.style.display&&(++i,n.tr.style.display="none"));for(s=l.parent;null!==s;)s.th.setAttribute("rowspan",parseInt(s.th.getAttribute("rowspan"))-i),s=s.parent;return 0!==l.descendants&&(l.th.textContent=" "+a+" "+l.th.getAttribute("data-rowHeader")),l.clickStatus="collapsed",l.th.setAttribute("rowspan",1),l.tr.style.display=""}},L=function(t,e){var n,l,r,s,c,i,d,h,u,p,f,g;if(t[e]&&(r=t[e],"expanded"!==r.clickStatus)){for(g=0,s=c=1,u=r.descendants;1<=u?c<=u:c>=u;s=1<=u?++c:--c)0!==r.descendants&&(l=t[e+s],0!==l.descendants&&(l.th.textContent=" "+a+" "+l.th.getAttribute("data-rowHeader")),l.clickStatus="collapsed",l.th.setAttribute("rowspan",1),"none"!==l.tr.style.display&&(--g,l.tr.style.display="none"));for(p=r.children,i=0,d=p.length;i<d;i++)n=p[i],"none"===n.tr.style.display&&(++g,n.tr.style.display="");for(r.th.setAttribute("rowspan",r.children.length+1),0!==r.descendants&&(r.th.textContent=" "+o+" "+r.th.getAttribute("data-rowHeader")),r.clickStatus="expanded",r.tr.style.display="",h=r.parent,f=[];null!==h;)h.th.setAttribute("rowspan",g+parseInt(h.th.getAttribute("rowspan"))),f.push(h=h.parent);return f}},W=function(t,e){if(t[e])return"collapsed"===t[e].clickStatus?K(t,e):S(t,e)},P=function(t,e){if(t[e])return"collapsed"===t[e].clickStatus?L(t,e):x(t,e)},T=function(t,e,n,l){var r,o,s,c,i,d,h;if(s=n.indexOf(l),!(s<0||s===n.length-1)){for(o=s,c=n.length-1;o<c;)h=t.th[o],h.th.textContent=" "+a+" "+n[o],h.clickStatus="collapsed",++o;for(o=0,i=e.length,d=[];o<i;)r=e[o],r.col===s?(x(e,r.node),d.push(o=o+r.descendants+1)):d.push(++o);return d}},R=function(t,e,n,l){var r,a,s,c,i,d,h,u,p;if(s=n.indexOf(l),!(s<0||s===n.length-1)){for(u=[],a=i=0,h=s;0<=h?i<=h:i>=h;a=0<=h?++i:--i)p=t.th[a],p.th.textContent=" "+o+" "+n[a],p.clickStatus="expanded",c=0,d=e.length,u.push(function(){var t;for(t=[];c<d;)r=e[c],r.col===a?(L(e,r.node),t.push(c=c+r.descendants+1)):t.push(++c);return t}());return u}},m=function(t,e,n,l){var r,o,s,c,i,d,h;if(s=n.indexOf(l),!(s<0||s===n.length-1)){for(o=s,c=n.length-1;o<c;)h=t[o].th,h.textContent=" "+a+" "+n[o],h.clickStatus="collapsed",++o;for(o=0,i=e.length,d=[];o<i;)r=e[o],r.col===s&&S(e,o),d.push(++o);return d}},E=function(t,e,n,l){var r,a,s,c,i,d,h,u,p;if(s=n.indexOf(l),!(s<0||s===n.length-1)){for(u=[],a=i=0,h=s;0<=h?i<=h:i>=h;a=0<=h?++i:--i)p=t[a].th,p.textContent=" "+o+" "+n[a],p.clickStatus="expanded",c=0,d=e.length,u.push(function(){var t;for(t=[];c<d;)r=e[c],r.col===a&&K(e,c),t.push(++c);return t}());return u}},q=function(t,e,n,l){var r,a;return r=n.indexOf(l),a=t[r].th,"collapsed"===a.clickStatus?E(t,e,n,l):m(t,e,n,l)},U=function(t,e,n,l){var r,a;return r=n.indexOf(l),a=t.th[r],"collapsed"===a.clickStatus?R(t,e,n,l):T(t,e,n,l)},(_=function(t,e,n,r){var a,o,s,w,C,A,S,x,k,H,K,E,L,R,_;if(E=[],s=[],H={},K=[],o=[],a=[],0!==t.length&&(E=j(e,"pvtRowLabel")),0!==n.length&&(s=j(r,"pvtColLabel")),k=document.createElement("table"),k.className="pvtTable",k.style.display="none",R=document.createElement("thead"),k.appendChild(R),0!==n.length){for(c(R,o,t,n),C=0,S=s.length;C<S;C++)w=s[C],d(o,a,w,t,n);i(o,a,n)}if(0!==t.length&&(f(R,H,t,n),0===n.length&&v(H.tr,t,n)),0!==n.length&&v(o[0].tr,t,n),L=document.createElement("tbody"),k.appendChild(L),0!==t.length){for(A=0,x=E.length;A<x;A++)w=E[A],b(L,K,w,t,n);g(H,K,t)}return y(K,a),_=u(t,n),0!==n.length&&h(_,a),p(L,_),k.setAttribute("data-numrows",e.length),k.setAttribute("data-numcols",r.length),l.collapseRowsAt||l.collapseColsAt||(k.style.display=""),l.collapseRowsAt&&setTimeout(function(){if(T(H,K,t,l.collapseRowsAt),!l.collapseColsAt)return k.style.display=""},0),l.collapseColsAt&&setTimeout(function(){return m(o,a,n,l.collapseColsAt),k.style.display=""},0),k})(O,I,w,C)},t.pivotUtilities.subtotal_renderers={"Table With Subtotal":function(t,e){return r(t,e)},"Table With Subtotal Bar Chart":function(e,n){return t(r(e,n)).barchart()},"Table With Subtotal Heatmap":function(e,n){return t(r(e,n)).heatmap()},"Table With Subtotal Row Heatmap":function(e,n){return t(r(e,n)).heatmap("rowheatmap")},"Table With Subtotal Col Heatmap":function(e,n){return t(r(e,n)).heatmap("colheatmap")}}})}).call(this);
//# sourceMappingURL=subtotal.min.js.map
