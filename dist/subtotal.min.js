(function(){var t,e=function(t,e){function r(){this.constructor=t}for(var l in e)n.call(e,l)&&(t[l]=e[l]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;(t=function(t){return"object"==typeof exports&&"object"==typeof module?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){var r,l;return r=function(t){function n(t,e){n.__super__.constructor.call(this,t,e)}var r;return e(n,t),r=function(t,e,n,r,l){var a,o,s,h,i,u,c;for(i=[],a=!1,h=0,u=r.length;h<u;h++)o=r[h],i.push(null!=(c=t[o])?c:"null"),s=i.join(String.fromCharCode(0)),e[s]||(e[s]=l(i.slice()),a=!0),e[s].push(t);return a&&n.push(i),i},n.prototype.processRecord=function(t){var e,n,l,a,o,s,h,i,u,c,d,p,f;if(f=[],e=[],this.allTotal.push(t),f=r(t,this.rowTotals,this.rowKeys,this.rowAttrs,function(t){return function(e){return t.aggregator(t,e,[])}}(this)),e=r(t,this.colTotals,this.colKeys,this.colAttrs,function(t){return function(e){return t.aggregator(t,[],e)}}(this)),u=f.length-1,c=e.length-1,!(u<0||c<0)){for(p=[],s=i=0,d=u;0<=d?i<=d:i>=d;s=0<=d?++i:--i)l=f.slice(0,s+1),o=l.join(String.fromCharCode(0)),this.tree[o]||(this.tree[o]={}),p.push(function(){var r,s,i;for(i=[],h=r=0,s=c;0<=s?r<=s:r>=s;h=0<=s?++r:--r)n=e.slice(0,h+1),a=n.join(String.fromCharCode(0)),this.tree[o][a]||(this.tree[o][a]=this.aggregator(this,l,n)),i.push(this.tree[o][a].push(t));return i}.call(this));return p}},n}(t.pivotUtilities.PivotData),t.pivotUtilities.SubtotalPivotData=r,l=function(e,r){var l,a,o,s,h,i,u,c,d,p,f,g,v,b,C,m,w,y,A,S,T,x,K,E,L,_,j;return w={localeStrings:{totals:"Totals"}},r=t.extend(w,r),T="▶",S="◢",f=e.colAttrs,K=e.rowAttrs,E=e.getRowKeys(),g=e.getColKeys(),j=e.tree,L=e.rowTotals,v=e.colTotals,l=e.allTotal,m=function(t,e,r,l){var a,o,s;if(o=document.createElement(t),e&&(o.className=e),null!==r&&void 0!==r&&(o.textContent=r),l)for(a in l)n.call(l,a)&&(s=l[a],o.setAttribute(a,s));return o},x=function(t,e){var n,r,l,a,o,s,h,i,u,c,d,p,f;for(s=t.length-1,o=t[0].length-1,c=[],a=[],p=m("th",e,t[0][0]),r=t[0][0],i=0,h={node:i,row:0,col:0,th:p,parent:null,children:[],descendants:o,leaves:1,flatKey:r},a[0]=h,c[0]=h,n=1;n<=o;)p=m("th",e,t[0][n]),r=r+String.fromCharCode(0)+t[0][n],++i,h={node:i,row:0,col:n,th:p,parent:c[n-1],children:[],descendants:o-n,leaves:1,flatKey:r},c[n]=h,c[n-1].children.push(h),++n;for(c[o].leaves=0,u=1;u<=s;){for(d=!0,r="",n=0;n<=o;)if(r=0===n?t[u][n]:r+String.fromCharCode(0)+t[u][n],t[u][n]===t[c[n].row][n]&&n!==o&&d)d=!0,++n;else{if(p=m("th",e,t[u][n]),++i,l={node:i,row:u,col:n,th:p,parent:null,children:[],descendants:0,leaves:1,flatKey:r},0===n)a.push(l);else for(l.parent=c[n-1],c[n-1].children.push(l),f=0;f<=n-1;)c[f].descendants=c[f].descendants+1,++f;c[n]=l,d=!1,++n}for(n=0;n<=o;)c[n].leaves=c[n].leaves+1,++n;c[o].leaves=0,++u}return a},a=function(t,e,n){var r,l,a,o,s,h;for(h=document.createElement("tr"),0!==n.length&&h.appendChild(m("th",null,null,{colspan:n.length,rowspan:f.length})),h.appendChild(m("th","pvtAxisLabel",f[0])),e[0]=h,t.appendChild(h),o=[],r=l=1,a=f.length;1<=a?l<=a:l>=a;r=1<=a?++l:--l)r<f.length&&(h=document.createElement("tr"),s=m("th","pvtAxisLabel",f[r]),h.appendChild(s),e[r]=h,t.appendChild(h),o.push(++r));return o},o=function(t,e,n,r,l,a){var s,h,i,u,c,d,p;for(u=n.children,h=0,i=u.length;h<i;h++)s=u[h],o(t,e,s,n,l,a);return p=t[n.col],d=n.th,n.col===l.length-1&&0!==a.length&&d.setAttribute("rowspan",2),0!==n.children.length&&d.setAttribute("colspan",n.descendants),p.appendChild(d),0!==n.children.length&&(c=l.length-n.col+(0!==a.length?1:0),d=m("th","pvtColLabel","",{rowspan:c}),p.appendChild(d)),n.tr=p,e.push(n)},u=function(t,e,n,r){var l,a,o,s,h;for(h=document.createElement("tr"),l=0,a=n.length;l<a;l++)o=n[l],s=m("th","pvtAxisLabel",o),h.appendChild(s);return 0!==r.length&&(s=m("th"),h.appendChild(s)),t.appendChild(h),e.tr=h},d=function(t,e,n){var l,a;return l=1,0!==e.length&&(l=e.length+(0===n.length?0:1)),a=m("th","pvtTotalLabel",r.localeStrings.totals,{rowspan:l}),t.appendChild(a)},c=function(t,e,n,r,l){var a,o,s,h,i,u,d,p;for(p=document.createElement("tr"),d=n.th,d.setAttribute("rowspan",n.descendants+1),n.col===r.length-1&&0!==l.length&&d.setAttribute("colspan",2),d.setAttribute("data-node",e.length),p.appendChild(d),0!==n.children.length&&(d.onclick=function(t){return t=t||window.event,_(e,parseInt(t.target.getAttribute("data-node")))},a=r.length-(n.col+1)+(0!==l.length?1:0),d=m("th","pvtRowLabel","",{colspan:a}),p.appendChild(d)),n.clickStatus="expanded",n.th.textContent=" "+S+" "+n.th.textContent,n.tr=p,e.push(n),t.appendChild(p),i=n.children,u=[],s=0,h=i.length;s<h;s++)o=i[s],u.push(c(t,e,o,r,l));return u},p=function(t,e){var n,r,l,a,o,s,h,i,u,c,d,p,f,g,v,b;for(c=[],o=0,h=t.length;o<h;o++){for(d=t[o],v=d.tr,a=d.flatKey,s=0,i=e.length;s<i;s++)r=e[s],l=r.flatKey,n=null!=(u=j[a][l])?u:{value:function(){return null},format:function(){return""}},b=n.value(),p="pvtVal",p=0!==r.children.length?p+" pvtSubtotal":p,p=p+" row"+d.row+" col"+r.col,f=m("td",p,n.format(b),{"data-value":b}),v.appendChild(f);g=L[a],b=g.value(),f=m("td","pvtTotal rowTotal",g.format(b),{"data-value":b,"data-row":"row"+d.row,"data-col":"col"+d.col}),c.push(v.appendChild(f))}return c},h=function(t,e){var n,l,a;return a=document.createElement("tr"),n=t.length+(0===e.length?0:1),l=m("th","pvtTotalLabel",r.localeStrings.totals,{colspan:n}),a.appendChild(l),a},s=function(t,e){var n,r,l,a,o,s,h;for(a=[],r=0,l=e.length;r<l;r++)n=e[r],s=v[n.flatKey],h=s.value(),o=m("td","pvtTotal colTotal",s.format(h),{"data-value":h,"data-for":"col"+n.col}),a.push(t.appendChild(o));return a},i=function(t,e){var n,r,a;return r=l,a=r.value(),n=m("td","pvtGrandTotal",r.format(a),{"data-value":a}),e.appendChild(n),t.appendChild(e)},b=function(t,e){var n,r,l,a,o,s,h,i;if(t[e]){for(r=t[e],h=0,l=a=1,s=r.descendants;1<=s?a<=s:a>=s;l=1<=s?++a:--a)0!==r.descendants&&(n=t[e+l],0!==n.descendants&&(i=n.th.textContent,n.th.textContent=i.substr(0,1)+T+i.substr(1+S.length)),n.clickStatus="collapsed",n.th.setAttribute("rowspan",1),"none"!==n.tr.style.display&&(++h,n.tr.style.display="none"));for(o=r.parent;null!==o;)o.th.setAttribute("rowspan",parseInt(o.th.getAttribute("rowspan"))-h),o=o.parent;return 0!==r.descendants&&(i=r.th.textContent,r.th.textContent=i.substr(0,1)+T+i.substr(1+T.length)),r.clickStatus="collapsed",r.th.setAttribute("rowspan",1),r.tr.style.display=""}},y=function(t,e){var n,r,l,a,o,s,h,i,u,c,d,p,f;if(t[e]){for(p=0,l=t[e],a=o=1,u=l.descendants;1<=u?o<=u:o>=u;a=1<=u?++o:--o)0!==l.descendants&&(r=t[e+a],0!==r.descendants&&(f=r.th.textContent,r.th.textContent=f.substr(0,1)+T+f.substr(1+S.length)),r.clickStatus="collapsed",r.th.setAttribute("rowspan",1),"none"!==r.tr.style.display&&(--p,r.tr.style.display="none"));for(c=l.children,s=0,h=c.length;s<h;s++)n=c[s],"none"===n.tr.style.display&&(++p,n.tr.style.display="");for(l.th.setAttribute("rowspan",l.children.length+1),0!==l.descendants&&(f=l.th.textContent,l.th.textContent=f.substr(0,1)+S+f.substr(1+S.length)),l.clickStatus="expanded",l.tr.style.display="",i=l.parent,d=[];null!==i;)i.th.setAttribute("rowspan",p+parseInt(i.th.getAttribute("rowspan"))),d.push(i=i.parent);return d}},_=function(t,e){if(t[e])return"collapsed"===t[e].clickStatus?y(t,e):b(t,e)},C=function(t,e){var n,r,l,a;for(r=0,l=t.length,a=[];r<l;)n=t[r],n.col===e?(b(t,n.node),a.push(r=r+n.descendants+1)):a.push(++r);return a},(A=function(t,e,n,l){var f,g,v,b,m,w,y,A,S,T,K,E,L,_,j,k,R;if(L=[],v=[],K={},E=[],g=[],f=[],0!==t.length&&(L=x(e,"pvtRowLabel")),0!==n.length&&(_=Date.now(),v=x(l,"pvtColLabel")),T=document.createElement("table"),T.className="pvtTable",k=document.createElement("thead"),T.appendChild(k),0!==n.length)for(a(k,g,t),w=0,A=v.length;w<A;w++)b=v[w],o(g,f,b,null,n,t);if(0!==t.length&&(u(k,K,t,n),0===n.length&&d(K.tr,n,t)),0!==n.length&&(_=Date.now(),d(g[0],n,t)),j=document.createElement("tbody"),T.appendChild(j),0!==t.length)for(y=0,S=L.length;y<S;y++)b=L[y],c(j,E,b,t,n);return p(E,f),R=h(t,n),0!==n.length&&s(R,f),i(j,R),T.setAttribute("data-numrows",e.length),T.setAttribute("data-numcols",l.length),m=t.indexOf(r.collapseRowsAt),m!==-1&&m!==t.length-1&&C(E,m),T})(K,E,f,g)},t.pivotUtilities.subtotal_renderers={"Table With Subtotal":function(t,e){return l(t,e)},"Table With Subtotal Bar Chart":function(e,n){return t(l(e,n)).barchart()},"Table With Subtotal Heatmap":function(e,n){return t(l(e,n)).heatmap()},"Table With Subtotal Row Heatmap":function(e,n){return t(l(e,n)).heatmap("rowheatmap")},"Table With Subtotal Col Heatmap":function(e,n){return t(l(e,n)).heatmap("colheatmap")}}})}).call(this);
//# sourceMappingURL=subtotal.min.js.map
