(function(){var t,e=function(t,e){function r(){this.constructor=t}for(var l in e)n.call(e,l)&&(t[l]=e[l]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;(t=function(t){return"object"==typeof exports&&"object"==typeof module?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){var r,l;return r=function(t){function n(t,e){n.__super__.constructor.call(this,t,e)}var r;return e(n,t),r=function(t,e,n,r,l){var a,o,s,i,c,h,u;for(c=[],a=!1,i=0,h=r.length;i<h;i++)o=r[i],c.push(null!=(u=t[o])?u:"null"),s=c.join(String.fromCharCode(0)),e[s]||(e[s]=l(c.slice()),a=!0),e[s].push(t);return a&&n.push(c),c},n.prototype.processRecord=function(t){var e,n,l,a,o,s,i,c,h,u,d,p,f;if(f=[],e=[],this.allTotal.push(t),f=r(t,this.rowTotals,this.rowKeys,this.rowAttrs,function(t){return function(e){return t.aggregator(t,e,[])}}(this)),e=r(t,this.colTotals,this.colKeys,this.colAttrs,function(t){return function(e){return t.aggregator(t,[],e)}}(this)),h=f.length-1,u=e.length-1,!(h<0||u<0)){for(p=[],s=c=0,d=h;0<=d?c<=d:c>=d;s=0<=d?++c:--c)l=f.slice(0,s+1),o=l.join(String.fromCharCode(0)),this.tree[o]||(this.tree[o]={}),p.push(function(){var r,s,c;for(c=[],i=r=0,s=u;0<=s?r<=s:r>=s;i=0<=s?++r:--r)n=e.slice(0,i+1),a=n.join(String.fromCharCode(0)),this.tree[o][a]||(this.tree[o][a]=this.aggregator(this,l,n)),c.push(this.tree[o][a].push(t));return c}.call(this));return p}},n}(t.pivotUtilities.PivotData),t.pivotUtilities.SubtotalPivotData=r,l=function(e,r){var l,a,o,s,i,c,h,u,d,p,f,g,v,C,b,y,w,A,x,S,m,k,T,H,E,R,K,_,j,I,L,O,N,W,V,q,P,U,D,B,G,Q,z,F,J,M,X;return K={localeStrings:{totals:"Totals"}},r=t.extend(K,r),o=null!=r.arrowCollapsed?r.arrowCollapsed:r.arrowCollapsed="▶",s=null!=r.arrowExpanded?r.arrowExpanded:r.arrowExpanded="◢",A="expanded",w="collapsed",x=e.colAttrs,D=e.rowAttrs,B=e.getRowKeys(),S=e.getColKeys(),X=e.tree,G=e.rowTotals,m=e.colTotals,a=e.allTotal,W=function(t,e){var n;return n=new RegExp("(?:^|\\s)"+e+"(?!\\S)","g"),t.className.match(n)},P=function(t,e){var n;return n=new RegExp("(?:^|\\s)"+e+"(?!\\S)","g"),t.className=t.className.replace(n,"")},l=function(t,e){if(!W(t,e))return t.className+=" "+e},U=function(t,e,n){return P(t,e),l(t,n)},R=function(t,e,r,l){var a,o,s;if(o=document.createElement(t),e&&(o.className=e),null!==r&&void 0!==r&&(o.textContent=r),l)for(a in l)n.call(l,a)&&(s=l[a],o.setAttribute(a,s));return o},q=function(t,e){var n,r,l,a,o,s,i,c,h,u,d,p,f;for(a=[],s=t.length-1,o=t[0].length-1,u=[],p=R("th",e,t[0][0]),r=t[0][0],c=0,i={node:c,row:0,col:0,th:p,parent:null,children:[],descendants:o,leaves:1,flatKey:r},a[0]=i,u[0]=i,n=1;n<=o;)p=R("th",e,t[0][n]),r=r+String.fromCharCode(0)+t[0][n],++c,i={node:c,row:0,col:n,th:p,parent:u[n-1],children:[],descendants:o-n,leaves:1,flatKey:r},u[n]=i,u[n-1].children.push(i),++n;for(u[o].leaves=0,h=1;h<=s;){for(d=!0,r="",n=0;n<=o;)if(r=0===n?t[h][n]:r+String.fromCharCode(0)+t[h][n],t[h][n]===t[u[n].row][n]&&n!==o&&d)d=!0,++n;else{if(p=R("th",e,t[h][n]),++c,l={node:c,row:h,col:n,th:p,parent:null,children:[],descendants:0,leaves:1,flatKey:r},0===n)a.push(l);else for(l.parent=u[n-1],u[n-1].children.push(l),f=0;f<=n-1;)u[f].descendants=u[f].descendants+1,++f;u[n]=l,d=!1,++n}for(n=0;n<=o;)u[n].leaves=u[n].leaves+1,++n;u[o].leaves=0,++h}return a},i=function(t,e,n,r,l,a){var o,i,c,h;return i=r[a],c=i,o="pvtAxisLabel",a<r.length-1&&(o+=" expanded",c=" "+s+" "+i),h=R("th",o,c),h.setAttribute("data-colAttr",i),l.appendChild(h),e.push({tr:l,th:h,clickStatus:A,expandedCount:0,nHeaders:0}),t.appendChild(l)},c=function(t,e,n,r){var l,a,o,s,c;for(c=document.createElement("tr"),0!==n.length&&c.appendChild(R("th",null,null,{colspan:n.length,rowspan:r.length})),i(t,e,n,r,c,0),s=[],l=a=1,o=r.length;1<=o?a<=o:a>=o;l=1<=o?++a:--a)l<r.length&&(c=document.createElement("tr"),s.push(i(t,e,n,r,c,l)));return s},h=function(t,e,n){var r,l,a,o,s,i;for(s=[],l=a=0,o=n.length-1;0<=o?a<=o:a>=o;l=0<=o?++a:--a)l<n.length-1&&(i=t[l].th,r=n[l],s.push(i.onclick=function(r){return r=r||window.event,F(t,e,n,r.target.getAttribute("data-colAttr"))}));return s},u=function(t,e,n,r,a){var o,i,c,h,d,p,f,g,v;for(d=n.children,c=0,h=d.length;c<h;c++)o=d[c],u(t,e,o,r,a);return i=t[n.col],++i.expandedCount,++i.nHeaders,v=i.tr,g=n.th,g.setAttribute("data-colHeader",g.textContent),n.col===a.length-1&&0!==r.length&&g.setAttribute("rowspan",2),0!==n.children.length&&g.setAttribute("colspan",n.descendants+1),g.setAttribute("data-node",e.length),v.appendChild(g),0!==n.children.length&&(l(g,A),g.textContent=" "+s+" "+g.textContent,g.onclick=function(n){return n=n||window.event,z(t,e,parseInt(n.target.getAttribute("data-node")))},p=a.length-(n.col+1)+(0!==r.length?1:0),f="pvtColLabel col"+n.row,g=R("th",f,"",{rowspan:p}),n.children[0].tr.appendChild(g),n.sTh=g),n.clickStatus=A,n.tr=v,e.push(n)},g=function(t,e,r,l){var a,o,i,c,h,u;u=document.createElement("tr"),e.hh=[];for(o in r)n.call(r,o)&&(i=r[o],c=i,a="pvtAxisLabel",o<r.length-1&&(a+=" expanded",c=" "+s+" "+i),h=R("th",a,c),h.setAttribute("data-rowAttr",i),u.appendChild(h),e.hh.push({th:h,clickStatus:A,expandedCount:0,nHeaders:0}));return 0!==l.length&&(h=R("th"),u.appendChild(h)),t.appendChild(u),e.tr=u},v=function(t,e,n){var r,l,a,o,s,i;for(o=[],r=l=0,a=n.length-1;0<=a?l<=a:l>=a;r=0<=a?++l:--l)r<n.length-1&&(i=t.hh[r],s=n[r],o.push(i.th.onclick=function(r){return r=r||window.event,M(t,e,n,r.target.getAttribute("data-rowAttr"))}));return o},b=function(t,e,n){var l,a;return l=1,0!==n.length&&(l=n.length+(0===e.length?0:1)),a=R("th","pvtTotalLabel",r.localeStrings.totals,{rowspan:l}),t.appendChild(a)},C=function(t,e,n,r,a,o){var i,c,h,u,d,p,f,g,v;for(h=e.hh[r.col],++h.expandedCount,++h.nHeaders,v=document.createElement("tr"),g=r.th,g.setAttribute("rowspan",r.descendants+1),g.setAttribute("data-rowHeader",g.textContent),r.col===a.length-1&&0!==o.length&&g.setAttribute("colspan",2),g.setAttribute("data-node",n.length),v.appendChild(g),0!==r.children.length&&(l(g,A),g.textContent=" "+s+" "+g.textContent,g.onclick=function(t){return t=t||window.event,J(e,n,parseInt(t.target.getAttribute("data-node")))},i=a.length-(r.col+1)+(0!==o.length?1:0),g=R("th","pvtRowLabel pvtRowSubtotal","",{colspan:i}),v.appendChild(g)),r.clickStatus=A,r.tr=v,n.push(r),t.appendChild(v),p=r.children,f=[],u=0,d=p.length;u<d;u++)c=p[u],f.push(C(t,e,n,c,a,o));return f},y=function(t,e){var n,r,l,a,o,s,i,c,h,u,d,p,f,g,v,C;for(u=[],o=0,i=t.length;o<i;o++){for(d=t[o],v=d.tr,a=d.flatKey,s=0,c=e.length;s<c;s++)r=e[s],l=r.flatKey,n=null!=(h=X[a][l])?h:{value:function(){return null},format:function(){return""}},C=n.value(),p="pvtVal",p=0!==r.children.length?p+" pvtColSubtotal":p,p=0!==d.children.length?p+" pvtRowSubtotal":p,p=p+" row"+d.row+" col"+r.row+" rowcol"+d.col+" colcol"+r.col,f=R("td",p,n.format(C),{"data-value":C}),v.appendChild(f);g=G[a],C=g.value(),p="pvtTotal rowTotal",p=0!==d.children.length?p+" pvtRowSubtotal":p,p=p+" row"+d.row+" rowcol"+d.col,f=R("td",p,g.format(C),{"data-value":C,"data-row":"row"+d.row,"data-col":"col"+d.col}),u.push(v.appendChild(f))}return u},p=function(t,e){var n,l,a;return a=document.createElement("tr"),n=t.length+(0===e.length?0:1),l=R("th","pvtTotalLabel",r.localeStrings.totals,{colspan:n}),a.appendChild(l),a},d=function(t,e){var n,r,l,a,o,s,i,c;for(a=[],r=0,l=e.length;r<l;r++)n=e[r],i=m[n.flatKey],c=i.value(),o="pvtVal pvtTotal colTotal",o=n.children.length?o+" pvtColSubtotal":o,o=o+" col"+n.row+" colcol"+n.col,s=R("td",o,i.format(c),{"data-value":c,"data-for":"col"+n.col}),a.push(t.appendChild(s));return a},f=function(t,e){var n,r,l;return r=a,l=r.value(),n=R("td","pvtGrandTotal",r.format(l),{"data-value":l}),e.appendChild(n),t.appendChild(e)},Q=function(e,n){if(n.th.style.display=e,n.children.length?t(n.th).closest("table.pvtTable").find("tbody tr td.pvtColSubtotal.col"+n.row+".colcol"+n.col).css("display",e):t(n.th).closest("table.pvtTable").find("tbody tr td.pvtVal.col"+n.row).not(".pvtColSubtotal").css("display",e),n.sTh)return n.sTh.style.display=e},k=function(t,e,n){var r,l,a,s,i,c,h,u,d,p,f,g;if(e[n]&&(s=e[n],s.clickStatus!==w)){for(l=0,i=c=1,d=s.descendants;1<=d?c<=d:c>=d;i=1<=d?++c:--c)0!==s.descendants&&(a=e[n-i],"none"!==a.th.style.display&&(++l,Q("none",a)));for(u=s.parent;null!==u;)u.th.setAttribute("colspan",parseInt(u.th.getAttribute("colspan"))-l),u=u.parent;if(0!==s.descendants&&(U(s.th,A,w),s.th.textContent=" "+o+" "+s.th.getAttribute("data-colHeader")),s.clickStatus=w,s.th.setAttribute("colspan",1),s.th.style.display="",r=t[s.col],r.expandedCount--,0===r.expandedCount){for(g=[],i=h=p=s.col,f=t.length-2;p<=f?h<=f:h>=f;i=p<=f?++h:--h)r=t[i],U(r.th,A,w),r.th.textContent=" "+o+" "+r.th.getAttribute("data-colAttr"),g.push(r.clickStatus=w);return g}}},_=function(t){var e,n,r,l,a;if("none"===t.th.style.display&&Q("",t),t.clickStatus!==w){for(l=t.children,a=[],n=0,r=l.length;n<r;n++)e=l[n],a.push(_(e));return a}},I=function(t,e,n){var r,l,a,o,i,c,h,u;if(e[n]&&(a=e[n],a.clickStatus!==A)){for(l=0,u=a.children,i=0,c=u.length;i<c;i++)r=u[i],l+=r.th.colSpan,"none"===r.th.style.display&&Q("",r),_(r);for(0!==a.descendants&&(U(a.th,w,A),a.th.textContent=" "+s+" "+a.th.getAttribute("data-colHeader")),a.th.setAttribute("colspan",l+1),a.clickStatus=A,a.th.style.display="",a.sTh&&(a.sTh.style.display=""),h=a.parent;null!==h;)h.th.setAttribute("colspan",l+parseInt(h.th.getAttribute("colspan"))),h=h.parent;return o=t[a.col],++o.expandedCount,o.expandedCount===o.nHeaders?(U(o.th,w,A),o.th.textContent=" "+s+" "+o.th.getAttribute("data-colAttr"),o.clickStatus=A):void 0}},H=function(t,e,n){var r,l,a,s,i,c,h,u,d,p,f,g,v;if(e[n]&&(l=e[n],l.clickStatus!==w)){for(v=0,a=i=1,u=l.descendants;1<=u?i<=u:i>=u;a=1<=u?++i:--i)0!==l.descendants&&(r=e[n+a],"none"!==r.tr.style.display&&(++v,r.tr.style.display="none"));for(h=l.parent;null!==h;)h.th.setAttribute("rowspan",parseInt(h.th.getAttribute("rowspan"))-v),h=h.parent;if(0!==l.descendants&&(U(l.th,A,w),l.th.textContent=" "+o+" "+l.th.getAttribute("data-rowHeader")),l.clickStatus=w,l.th.setAttribute("rowspan",1),l.tr.style.display="",g=t.hh[l.col],g.expandedCount--,0===g.expandedCount){for(f=[],s=c=d=l.col,p=t.hh.length-2;d<=p?c<=p:c>=p;s=d<=p?++c:--c)g=t.hh[s],U(g.th,A,w),g.th.textContent=" "+o+" "+g.th.getAttribute("data-rowAttr"),f.push(g.clickStatus=w);return f}}},j=function(t){var e,n,r,l,a;if("none"===t.tr.style.display&&(t.tr.style.display=""),t.clickStatus!==w){for(l=t.children,a=[],n=0,r=l.length;n<r;n++)e=l[n],a.push(j(e));return a}},O=function(t,e,n){var r,l,a,o,i,c,h,u;if(e[n]&&(l=e[n],l.clickStatus!==A)){for(u=0,h=l.children,o=0,i=h.length;o<i;o++)r=h[o],u+=r.th.rowSpan,"none"===r.tr.style.display&&(r.tr.style.display=""),j(r);for(0!==l.descendants&&(U(l.th,w,A),l.th.textContent=" "+s+" "+l.th.getAttribute("data-rowHeader")),l.th.setAttribute("rowspan",u+1),l.clickStatus=A,l.tr.style.display="",c=l.parent;null!==c;)c.th.setAttribute("rowspan",u+parseInt(c.th.getAttribute("rowspan"))),c=c.parent;return a=t.hh[l.col],++a.expandedCount,a.expandedCount===a.nHeaders?(U(a.th,w,A),a.th.textContent=" "+s+" "+a.th.getAttribute("data-rowAttr"),a.clickStatus=A):void 0}},z=function(t,e,n){var r;if(e[n])return r=e[n],r.clickStatus===w?I(t,e,n):k(t,e,n),r.th.scrollIntoView},J=function(t,e,n){if(e[n])return e[n].clickStatus===w?O(t,e,n):H(t,e,n)},T=function(t,e,n,r){var l,a,s,i,c,h,u;if(i="string"==typeof r?n.indexOf(r):r,!(i<0||i===n.length-1)){for(s=i,c=n.length-1;s<c;)a=t[s],U(a.th,A,w),a.th.textContent=" "+o+" "+n[s],a.clickStatus=w,++s;for(s=0,h=e.length,u=[];s<h;)l=e[s],l.col===i&&l.clickStatus!==w&&"none"!==l.th.style.display&&k(t,e,parseInt(l.th.getAttribute("data-node"))),u.push(++s);return u}},L=function(t,e,n,r){var l,a,i,c,h,u,d,p,f,g;if(h="string"==typeof r?n.indexOf(r):r,!(h<0||h===n.length-1)){for(c=d=0,f=h;0<=f?d<=f:d>=f;c=0<=f?++d:--d)for(i=t[c],U(i.th,w,A),i.th.textContent=" "+s+" "+n[c],i.clickStatus=A,u=0,p=e.length;u<p;)a=e[u],a.col===c&&I(t,e,u),++u;for(++h,g=[];h<n.length-1;)l=t[h],0===l.expandedCount?(U(l.th,A,w),l.th.textContent=" "+o+" "+n[h],l.clickStatus=w):l.expandedCount===l.nHeaders&&(U(l.th,w,A),l.th.textContent=" "+s+" "+n[h],l.clickStatus=A),g.push(++h);return g}},E=function(t,e,n,r){var l,a,s,i,c,h,u;if(s="string"==typeof r?n.indexOf(r):r,!(s<0||s===n.length-1)){for(a=s,c=n.length-1;a<c;)l=t.hh[a],U(l.th,A,w),l.th.textContent=" "+o+" "+n[a],l.clickStatus=w,++a;for(i=0,h=e.length,u=[];i<h;)l=e[i],l.col===s&&l.clickStatus!==w&&"none"!==l.tr.style.display?(H(t,e,i),u.push(i=i+l.descendants+1)):u.push(++i);return u}},N=function(t,e,n,r){var l,a,i,c,h,u,d,p,f,g;if(c="string"==typeof r?n.indexOf(r):r,!(c<0||c===n.length-1)){for(i=u=0,p=c;0<=p?u<=p:u>=p;i=0<=p?++u:--u)for(a=t.hh[i],U(a.th,w,A),a.th.textContent=" "+s+" "+n[i],a.clickStatus=A,h=0,d=e.length;h<d;)l=e[h],l.col===i?(O(t,e,h),h=h+l.descendants+1):++h;for(++c,f=[];c<n.length-1;)g=t.hh[c],0===g.expandedCount?(U(g.th,A,w),g.th.textContent=" "+o+" "+n[c],g.clickStatus=w):g.expandedCount===g.nHeaders&&(U(g.th,w,A),g.th.textContent=" "+s+" "+n[c],g.clickStatus=A),f.push(++c);return f}},F=function(t,e,n,r){var l,a;return a=n.indexOf(r),l=t[a],l.clickStatus===w?L(t,e,n,r):T(t,e,n,r)},M=function(t,e,n,r){var l,a;return l=n.indexOf(r),a=t.hh[l],a.clickStatus===w?N(t,e,n,r):E(t,e,n,r)},(V=function(t,e,n,l){var a,o,s,i,w,A,x,S,m,k,H,R,K,_,j;if(R=[],s=[],k={},H=[],o=[],a=[],0!==t.length&&0!==e.length&&(R=q(e,"pvtRowLabel")),0!==n.length&&0!==l.length&&(s=q(l,"pvtColLabel")),m=document.createElement("table"),m.className="pvtTable",m.style.display="none",_=document.createElement("thead"),m.appendChild(_),0!==n.length){for(c(_,o,t,n),w=0,x=s.length;w<x;w++)i=s[w],u(o,a,i,t,n);h(o,a,n)}if(0!==t.length&&(g(_,k,t,n),0===n.length&&b(k.tr,t,n)),0!==n.length&&b(o[0].tr,t,n),K=document.createElement("tbody"),m.appendChild(K),0!==t.length){for(A=0,S=R.length;A<S;A++)i=R[A],C(K,k,H,i,t,n);v(k,H,t)}return y(H,a),j=p(t,n),0!==n.length&&d(j,a),f(K,j),m.setAttribute("data-numrows",e.length),m.setAttribute("data-numcols",l.length),null==r.collapseRowsAt&&null==r.collapseColsAt&&(m.style.display=""),null!=r.collapseRowsAt&&setTimeout(function(){if(E(k,H,t,r.collapseRowsAt),!r.collapseColsAt)return m.style.display=""},0),null!=r.collapseColsAt&&setTimeout(function(){return T(o,a,n,r.collapseColsAt),m.style.display=""},0),m})(D,B,x,S)},t.pivotUtilities.subtotal_renderers={"Table With Subtotal":function(t,e){return l(t,e)},"Table With Subtotal Bar Chart":function(e,n){return t(l(e,n)).barchart()},"Table With Subtotal Heatmap":function(e,n){return t(l(e,n)).heatmap("heatmap",n)},"Table With Subtotal Row Heatmap":function(e,n){return t(l(e,n)).heatmap("rowheatmap",n)},"Table With Subtotal Col Heatmap":function(e,n){return t(l(e,n)).heatmap("colheatmap",n)}}})}).call(this);
//# sourceMappingURL=subtotal.min.js.map
