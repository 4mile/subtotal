(function(){var t,e=function(t,e){function r(){this.constructor=t}for(var a in e)n.call(e,a)&&(t[a]=e[a]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},n={}.hasOwnProperty;(t=function(t){return"object"==typeof exports&&"object"==typeof module?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){var r,a;return r=function(t){function n(t,e){n.__super__.constructor.call(this,t,e)}var r;return e(n,t),r=function(t,e,n,r,a){var l,o,s,i,h,d,c;for(h=[],l=!1,i=0,d=r.length;i<d;i++)o=r[i],h.push(null!=(c=t[o])?c:"null"),s=h.join(String.fromCharCode(0)),e[s]||(e[s]=a(h.slice()),l=!0),e[s].push(t);return l&&n.push(h),h},n.prototype.processRecord=function(t){var e,n,a,l,o,s,i,h,d,c,u,p,f;if(f=[],e=[],this.allTotal.push(t),f=r(t,this.rowTotals,this.rowKeys,this.rowAttrs,function(t){return function(e){return t.aggregator(t,e,[])}}(this)),e=r(t,this.colTotals,this.colKeys,this.colAttrs,function(t){return function(e){return t.aggregator(t,[],e)}}(this)),d=f.length-1,c=e.length-1,!(d<0||c<0)){for(p=[],s=h=0,u=d;0<=u?h<=u:h>=u;s=0<=u?++h:--h)a=f.slice(0,s+1),o=a.join(String.fromCharCode(0)),this.tree[o]||(this.tree[o]={}),p.push(function(){var r,s,h;for(h=[],i=r=0,s=c;0<=s?r<=s:r>=s;i=0<=s?++r:--r)n=e.slice(0,i+1),l=n.join(String.fromCharCode(0)),this.tree[o][l]||(this.tree[o][l]=this.aggregator(this,a,n)),h.push(this.tree[o][l].push(t));return h}.call(this));return p}},n}(t.pivotUtilities.PivotData),t.pivotUtilities.SubtotalPivotData=r,a=function(e,r){var a,l,o,s,i,h,d,c,u,p,f,g,b,v,y,w,A,C,m,x,S,T,k,H,K,E,L,_,j,R,I,W,D,O,q;return k={localeStrings:{totals:"Totals"}},r=t.extend(k,r),l="▶",o="◢",w=e.colAttrs,j=e.rowAttrs,R=e.getRowKeys(),A=e.getColKeys(),q=e.tree,I=e.rowTotals,C=e.colTotals,a=e.allTotal,T=function(t,e,r,a){var l,o,s;if(o=document.createElement(t),e&&(o.className=e),null!==r&&void 0!==r&&(o.textContent=r),a)for(l in a)n.call(a,l)&&(s=a[l],o.setAttribute(l,s));return o},_=function(t,e){var n,r,a,l,o,s,i,h,d,c,u,p,f;for(s=t.length-1,o=t[0].length-1,c=[],l=[],p=T("th",e,t[0][0]),r=t[0][0],h=0,i={node:h,row:0,col:0,th:p,parent:null,children:[],descendants:o,leaves:1,flatKey:r},l[0]=i,c[0]=i,n=1;n<=o;)p=T("th",e,t[0][n]),r=r+String.fromCharCode(0)+t[0][n],++h,i={node:h,row:0,col:n,th:p,parent:c[n-1],children:[],descendants:o-n,leaves:1,flatKey:r},c[n]=i,c[n-1].children.push(i),++n;for(c[o].leaves=0,d=1;d<=s;){for(u=!0,r="",n=0;n<=o;)if(r=0===n?t[d][n]:r+String.fromCharCode(0)+t[d][n],t[d][n]===t[c[n].row][n]&&n!==o&&u)u=!0,++n;else{if(p=T("th",e,t[d][n]),++h,a={node:h,row:d,col:n,th:p,parent:null,children:[],descendants:0,leaves:1,flatKey:r},0===n)l.push(a);else for(a.parent=c[n-1],c[n-1].children.push(a),f=0;f<=n-1;)c[f].descendants=c[f].descendants+1,++f;c[n]=a,u=!1,++n}for(n=0;n<=o;)c[n].leaves=c[n].leaves+1,++n;c[o].leaves=0,++d}return l},s=function(t,e,n,r,a,l){var s,i,h;return s=r[l],h=T("th","pvtAxisLabel",s),i=s,l<r.length-1&&(i=" "+o+" "+s),h=T("th","pvtAxisLabel",i),h.setAttribute("data-colAttr",s),a.appendChild(h),e.push({tr:a,th:h,clickStatus:"expanded"}),t.appendChild(a)},i=function(t,e,n,r){var a,l,o,i,h;for(h=document.createElement("tr"),0!==n.length&&h.appendChild(T("th",null,null,{colspan:n.length,rowspan:r.length})),s(t,e,n,r,h,0),i=[],a=l=1,o=r.length;1<=o?l<=o:l>=o;a=1<=o?++l:--l)a<r.length&&(h=document.createElement("tr"),i.push(s(t,e,n,r,h,a)));return i},h=function(t,e,n){var r,a,l,o,s,i;for(s=[],a=l=0,o=n.length-1;0<=o?l<=o:l>=o;a=0<=o?++l:--l)a<n.length-1&&(i=t[a].th,r=n[a],s.push(i.onclick=function(t){return t=t||window.event,alert(t.target.getAttribute("data-colAttr"))}));return s},d=function(t,e,n,r,a){var l,s,i,h,c,u,p;for(h=n.children,s=0,i=h.length;s<i;s++)l=h[s],d(t,e,l,r,a);return p=t[n.col].tr,u=n.th,u.setAttribute("data-colHeader",u.textContent),n.col===a.length-1&&0!==r.length&&u.setAttribute("rowspan",2),0!==n.children.length&&u.setAttribute("colspan",n.descendants+1),u.setAttribute("data-node",e.length),p.appendChild(u),0!==n.children.length&&(u.textContent=" "+o+" "+u.textContent,u.onclick=function(t){return t=t||window.event,W(e,parseInt(t.target.getAttribute("data-node")))},c=a.length-(n.col+1)+(0!==r.length?1:0),u=T("th","pvtColLabel","",{rowspan:c}),n.children[0].tr.appendChild(u),n.sTh=u),n.clickStatus="expanded",n.tr=p,n.idx=e.length,n.pos=e.length+r.length+1,e.push(n)},f=function(t,e,n,r){var a,l,s,i,h;h=document.createElement("tr"),e.th=[];for(a in n)l=n[a],s=l,a<n.length-1&&(s=" "+o+" "+l),i=T("th","pvtAxisLabel",s),i.setAttribute("data-rowAttr",l),h.appendChild(i),e.th.push({th:i,clickStatus:"expanded"});return 0!==r.length&&(i=T("th"),h.appendChild(i)),t.appendChild(h),e.tr=h},g=function(t,e,n){var r,a,l,o,s,i;for(o=[],r=a=0,l=n.length-1;0<=l?a<=l:a>=l;r=0<=l?++a:--a)r<n.length-1&&(i=t.th[r],s=n[r],o.push(i.th.onclick=function(r){return r=r||window.event,O(t,e,n,r.target.getAttribute("data-rowAttr"))}));return o},v=function(t,e,n){var a,l;return a=1,0!==n.length&&(a=n.length+(0===e.length?0:1)),l=T("th","pvtTotalLabel",r.localeStrings.totals,{rowspan:a}),t.appendChild(l)},b=function(t,e,n,r,a){var l,s,i,h,d,c,u,p;for(p=document.createElement("tr"),u=n.th,u.setAttribute("rowspan",n.descendants+1),u.setAttribute("data-rowHeader",u.textContent),n.col===r.length-1&&0!==a.length&&u.setAttribute("colspan",2),u.setAttribute("data-node",e.length),p.appendChild(u),0!==n.children.length&&(u.textContent=" "+o+" "+u.textContent,u.onclick=function(t){return t=t||window.event,D(e,parseInt(t.target.getAttribute("data-node")))},l=r.length-(n.col+1)+(0!==a.length?1:0),u=T("th","pvtRowLabel","",{colspan:l}),p.appendChild(u)),n.clickStatus="expanded",n.tr=p,e.push(n),t.appendChild(p),d=n.children,c=[],i=0,h=d.length;i<h;i++)s=d[i],c.push(b(t,e,s,r,a));return c},y=function(t,e){var n,r,a,l,o,s,i,h,d,c,u,p,f,g,b,v;for(c=[],o=0,i=t.length;o<i;o++){for(u=t[o],b=u.tr,l=u.flatKey,s=0,h=e.length;s<h;s++)r=e[s],a=r.flatKey,n=null!=(d=q[l][a])?d:{value:function(){return null},format:function(){return""}},v=n.value(),p="pvtVal",p=0!==r.children.length?p+" pvtSubtotal":p,p=p+" row"+u.row+" col"+r.col,f=T("td",p,n.format(v),{"data-value":v}),b.appendChild(f);g=I[l],v=g.value(),f=T("td","pvtTotal rowTotal",g.format(v),{"data-value":v,"data-row":"row"+u.row,"data-col":"col"+u.col}),c.push(b.appendChild(f))}return c},u=function(t,e){var n,a,l;return l=document.createElement("tr"),n=t.length+(0===e.length?0:1),a=T("th","pvtTotalLabel",r.localeStrings.totals,{colspan:n}),l.appendChild(a),l},c=function(t,e){var n,r,a,l,o,s,i;for(l=[],r=0,a=e.length;r<a;r++)n=e[r],s=C[n.flatKey],i=s.value(),o=T("td","pvtTotal colTotal",s.format(i),{"data-value":i,"data-for":"col"+n.col}),l.push(t.appendChild(o));return l},p=function(t,e){var n,r,l;return r=a,l=r.value(),n=T("td","pvtGrandTotal",r.format(l),{"data-value":l}),e.appendChild(n),t.appendChild(e)},m=function(e,n){var r,a,o,s,i,h,d;if(e[n]){for(r=0,o=e[n],s=i=1,d=o.descendants;1<=d?i<=d:i>=d;s=1<=d?++i:--i)0!==o.descendants&&(console.log("c: "+n+", c-i: "+(n-s)),a=e[n-s],console.log(a.th.textContent+", "+(n-s)),0!==a.descendants&&(a.th.textContent=" "+l+" "+a.th.getAttribute("data-colHeader")),a.clickStatus="collapsed",a.th.setAttribute("colspan",1),"none"!==a.th.style.display&&(++r,a.th.style.display="none",t("table.pvtTable tbody tr td:nth-child("+a.pos+")").hide(),a.sTh&&(a.sTh.style.display="none")));for(h=o.parent;null!==h;)h.th.setAttribute("colspan",parseInt(h.th.getAttribute("colspan"))-r),h=h.parent;return 0!==o.descendants&&(o.th.textContent=" "+l+" "+o.th.getAttribute("data-colHeader")),o.clickStatus="collapsed",o.th.setAttribute("colspan",1),o.tr.style.display=""}},H=function(e,n){var r,a,s,i,h,d,c,u,p,f,g,b;if(e[n]){for(a=0,i=e[n],h=d=1,f=i.descendants;1<=f?d<=f:d>=f;h=1<=f?++d:--d)0!==i.descendants&&(console.log("c: "+n+", c-i: "+(n-h)),s=e[n-h],console.log(s.th.textContent+", "+(n-h)),0!==s.descendants&&(s.th.textContent=" "+l+" "+s.th.getAttribute("data-colHeader")),s.clickStatus="collapsed",s.th.setAttribute("colspan",1),"none"!==s.th.style.display&&(++a,s.th.style.display="none",t("table.pvtTable tbody tr td:nth-child("+s.pos+")").hide(),s.sTh&&(s.sTh.style.display="none")));for(g=i.children,c=0,u=g.length;c<u;c++)r=g[c],"none"===r.th.style.display&&(++a,r.th.style.display="",r.sTh&&(r.sTh.style.display=""),t("table.pvtTable tbody tr td:nth-child("+r.pos+")").show());for(i.th.setAttribute("colspan",i.children.length+1),0!==i.descendants&&(i.th.textContent=" "+o+" "+i.th.getAttribute("data-colHeader")),i.clickStatus="expanded",i.th.style.display="",i.sTh&&(i.sTh.style.display=""),p=i.parent,b=[];null!==p;)p.th.setAttribute("colspan",a+parseInt(p.th.getAttribute("colspan"))),b.push(p=p.parent);return b}},x=function(t,e){var n,r,a,o,s,i,h;if(t[e]){for(r=t[e],h=0,a=o=1,i=r.descendants;1<=i?o<=i:o>=i;a=1<=i?++o:--o)0!==r.descendants&&(n=t[e+a],0!==n.descendants&&(n.th.textContent=" "+l+" "+n.th.getAttribute("data-rowHeader")),n.clickStatus="collapsed",n.th.setAttribute("rowspan",1),"none"!==n.tr.style.display&&(++h,n.tr.style.display="none"));for(s=r.parent;null!==s;)s.th.setAttribute("rowspan",parseInt(s.th.getAttribute("rowspan"))-h),s=s.parent;return 0!==r.descendants&&(r.th.textContent=" "+l+" "+r.th.getAttribute("data-rowHeader")),r.clickStatus="collapsed",r.th.setAttribute("rowspan",1),r.tr.style.display=""}},K=function(t,e){var n,r,a,s,i,h,d,c,u,p,f,g;if(t[e]){for(g=0,a=t[e],s=i=1,u=a.descendants;1<=u?i<=u:i>=u;s=1<=u?++i:--i)0!==a.descendants&&(r=t[e+s],0!==r.descendants&&(r.th.textContent=" "+l+" "+r.th.getAttribute("data-rowHeader")),r.clickStatus="collapsed",r.th.setAttribute("rowspan",1),"none"!==r.tr.style.display&&(--g,r.tr.style.display="none"));for(p=a.children,h=0,d=p.length;h<d;h++)n=p[h],"none"===n.tr.style.display&&(++g,n.tr.style.display="");for(a.th.setAttribute("rowspan",a.children.length+1),0!==a.descendants&&(a.th.textContent=" "+o+" "+a.th.getAttribute("data-rowHeader")),a.clickStatus="expanded",a.tr.style.display="",c=a.parent,f=[];null!==c;)c.th.setAttribute("rowspan",g+parseInt(c.th.getAttribute("rowspan"))),f.push(c=c.parent);return f}},W=function(t,e){if(t[e])return"collapsed"===t[e].clickStatus?H(t,e):m(t,e)},D=function(t,e){if(t[e])return"collapsed"===t[e].clickStatus?K(t,e):x(t,e)},S=function(t,e,n,r){var a,o,s,i,h,d,c;if(s=n.indexOf(r),!(s<0||s===n.length-1)){for(o=s,i=n.length-1;o<i;)c=t.th[o],c.th.textContent=" "+l+" "+n[o],c.clickStatus="collapsed",++o;for(o=0,h=e.length,d=[];o<h;)a=e[o],a.col===s?(x(e,a.node),d.push(o=o+a.descendants+1)):d.push(++o);return d}},E=function(t,e,n,r){var a,l,s,i,h,d,c,u,p;if(s=n.indexOf(r),!(s<0||s===n.length-1)){for(u=[],l=h=0,c=s;0<=c?h<=c:h>=c;l=0<=c?++h:--h)p=t.th[l],p.th.textContent=" "+o+" "+n[l],p.clickStatus="expanded",i=0,d=e.length,u.push(function(){var t;for(t=[];i<d;)a=e[i],a.col===l?(K(e,a.node),t.push(i=i+a.descendants+1)):t.push(++i);return t}());return u}},O=function(t,e,n,r){var a,l;return a=n.indexOf(r),l=t.th[a],"collapsed"===l.clickStatus?E(t,e,n,r):S(t,e,n,r)},(L=function(t,e,n,a){var l,o,s,w,A,C,m,x,T,k,H,K,E,L,j,R;if(K=[],s=[],k={},H=[],o=[],l=[],0!==t.length&&(K=_(e,"pvtRowLabel")),0!==n.length&&(E=Date.now(),s=_(a,"pvtColLabel")),T=document.createElement("table"),T.className="pvtTable",j=document.createElement("thead"),T.appendChild(j),0!==n.length){for(i(j,o,t,n),A=0,m=s.length;A<m;A++)w=s[A],d(o,l,w,t,n);h(o,l,n)}if(0!==t.length&&(f(j,k,t,n),0===n.length&&v(k.tr,t,n)),0!==n.length&&(E=Date.now(),v(o[0].tr,t,n)),L=document.createElement("tbody"),T.appendChild(L),0!==t.length){for(C=0,x=K.length;C<x;C++)w=K[C],b(L,H,w,t,n);g(k,H,t)}return y(H,l),R=u(t,n),0!==n.length&&c(R,l),p(L,R),T.setAttribute("data-numrows",e.length),T.setAttribute("data-numcols",a.length),r.collapseRowsAt&&S(k,H,t,r.collapseRowsAt),T})(j,R,w,A)},t.pivotUtilities.subtotal_renderers={"Table With Subtotal":function(t,e){return a(t,e)},"Table With Subtotal Bar Chart":function(e,n){return t(a(e,n)).barchart()},"Table With Subtotal Heatmap":function(e,n){return t(a(e,n)).heatmap()},"Table With Subtotal Row Heatmap":function(e,n){return t(a(e,n)).heatmap("rowheatmap")},"Table With Subtotal Col Heatmap":function(e,n){return t(a(e,n)).heatmap("colheatmap")}}})}).call(this);
//# sourceMappingURL=subtotal.min.js.map
